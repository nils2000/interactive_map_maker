<!DOCTYPE html>
<html>
<!--https://www.mediaevent.de/tutorial/svg-image.html-->

<head>
    <script>
    	var window_height = window.innerHeight;
    	var window_width = window.innerWidth;
    	var my_image = new Image();
		my_image.src = 'test.png';
        var image_height = my_image.height;
        var image_width = my_image.width;
    </script>
    <meta charset='utf-8'>
    <title>Gewölbe2</title>
    <style>
  
        @media (min-width: 500px) {
            .svgbg {
                background-image: url('test.png');
                background-size: contain;
                background-repeat: no-repeat;
            
            }
                .descr_link {
            fill-opacity: 0.3;
            color: white;
        }
        }
    </style>
</head>

<body>
	<div style="width: 100%" onclick="dragged(event)">
			<button draggable="true" style="margin-left: 70%" ondrag="dragged(event)">Test</button>
	</div>
    <div style="float:right; background-color: lightgrey; width:50%;height:50%;">
        <div id="description" style="float:right; background-color: lightgrey; width:100%;height:50%;">
        Hier kommt die Beschreibung hin ...
        </div>
            <div id="monster" style="float:right; background-color: lightpink; width:100%;height:50%;">
        Hier die Monsterwerte .....
        </div> 
    </div>
    <svg id="map" class="svgbg" width="50%" height="800">
    </svg>

    <script>
        function describe(num) {
            let descr_div = document.getElementById("description");
            descr_div.innerHTML = beschreibung[num];
        }
        let beschreibung = Object();
        beschreibung[""] = ``;
        beschreibung[""] = ``;
        beschreibung[""] = ``;
        beschreibung[""] = ``;
        beschreibung[""] = ``;
        beschreibung[""] = ``;
        beschreibung[""] = ``;

        
           function rect_elem(x1, y1, x2, y2) {
            //var svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
            //svg.setAttributeNS(null, "id", "map");
            //svg.setAttributeNS(null, "class", "svgbg");
            //svg.setAttributeNS(null, "height", "100%");
            //svg.setAttributeNS(null, "width", "50%");
            //svg.setAttributeNS(null, "viewBox", "0 0 452 828");

            //document.getElementsByTagName('body')[0].appendChild(svg);
            

            //var txtElem = document.createElementNS("http://www.w3.org/2000/svg", "text");
            //txtElem.setAttributeNS(null, "x", 20);
            //txtElem.setAttributeNS(null, "y", 40);
            var canvas = document.getElementById("map");
            var conv_fact = 800/image_height;
            var rectElem = document.createElementNS("http://www.w3.org/2000/svg", "rect");
            rectElem.setAttributeNS(null, "x", x1 * conv_fact);
            rectElem.setAttributeNS(null, "y", y1 * conv_fact);
            rectElem.setAttributeNS(null, "width", (x2 - x1) * conv_fact);
            rectElem.setAttributeNS(null, "height", (y2 - y1) * conv_fact);
            rectElem.setAttributeNS(null, "class", "descr_link");
            return rectElem;

        }
        
        function add_description_link(room, x1, y1, x2, y2){
            var rectElem = rect_elem(x1, y1, x2, y2);
            rectElem.setAttributeNS(null, "onclick", "describe('" + room + "')");


            //var theText = "Hello World! This is SVG Text created with JavaScript.";
            //var theMSG = document.createTextNode(theText);
            //txtElem.appendChild(theMSG);
            var svgDoc = document.getElementById('map');
            svgDoc.appendChild(rectElem);
            }
            
            function add_svg_anchor(target, x1, y1, x2, y2){
            var rectElem = rect_elem(x1, y1, x2, y2);
            rectElem.setAttributeNS(null,"onclick", "change_location('"+target+"')");
            var svgDoc = document.getElementById('map');
            svgDoc.appendChild(rectElem);
            }
        function change_location(target){
            window.location.href = target;
            }
            
            add_description_link("38",594,999,1517,1775);
            
            add_svg_anchor("Gewölbe1.html",33,569,336,777);

        sample = a=>{return a[Math.floor(Math.random()*a.length)];}

        function dragged(ev){
        	console.log(ev);
        }
            
    </script>
        }
</body>

</html>
